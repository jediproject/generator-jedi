/*
 ng-jedi-utilities v0.0.1
 Utilities to make life easier on settings and other needs during development with angularjs
 https://github.com/jediproject/ng-jedi-utilities
*/

!function(a){return"function"!=typeof define?("undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="jedi.utilities"),a()):void define(["ng-jedi-dialogs","slimscroll","angular"],a)}(function(){"use strict";angular.module("jedi.utilities.directives",[]).directive("jdSlimScroll",[function(){return{restrict:"A",link:function(a,b,c){return b.slimScroll({height:c.scrollHeight||"100%"})}}}]).directive("jdValidateEquals",[function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.ngModel,f=c.jdValidateEquals;a.$watch(e,function(b){b?d.$setValidity("equal",a.$eval(e)===a.$eval(f)):d.$setValidity("equal",!0)}),a.$watch(f,function(b){d.$setValidity("equal",a.$eval(e)===a.$eval(f))})}}}]).directive("jdFullScreenPage",function(){return{restrict:"A",controller:["$scope","$element","$location",function(a,b,c){jQuery("body").addClass("body-wide"),a.$watch(function(){return c.path()},function(a,b){a!==b&&jQuery("body").removeClass("body-wide")})}]}}).directive("jdDynamicDirective",["$compile","$interpolate",function(a,b){return{restrict:"A",compile:function(c,d){var e=c.attr("jd-dynamic-directive");if(c.removeAttr("jd-dynamic-directive"),e){var f=c.children();return c.empty(),{pre:function(a,c){e.indexOf("{{")>-1&&(e=b(e)(a));var d=e.split("|");angular.forEach(d,function(a){var a=a.split("=");c.attr(a[0],a.length>1?a[1]:"")})},post:function(b,c){c.append(f),a(c)(b)}}}}}}]).directive("jdInterpolateFormat",["$interpolate",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f=c.attr("jd-interpolate-format");e.$formatters.push(function(b){return a(f)(b)})}}}]).directive("jdAsyncValidate",["$q",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$asyncValidators.jdAsyncValidate=function(c,e){return a(function(a,f){b.$eval(d.jdAsyncValidate)(c,e,a,f)})}}}}]).directive("jdEnter",function(){return function(a,b,c){b.bind("keydown.jdEnter keypress.jdEnter",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.jdEnter)}),b.preventDefault())}),a.$on("$destroy",function(){b.unbind("keydown.jdEnter keypress.jdEnter")})}}).directive("jdDependsOn",["$log",function(a){return{restrict:"A",link:function(b,c,d){function e(a){var b=!0;return angular.forEach(a,function(a,c){a||(b=!1)}),b}c.attr("readonly","true");var f=d.jdDependsOn;if(""==f)return a.error("A diretiva DependsOn precisa de conteúdo válido para funcionar corretamente. Elemento não carregado."),!1;var g=[];angular.forEach(f.split(";"),function(a){this.push(a.trim())},g);var h={};angular.forEach(g,function(a){h[a]=!1,b.$watch(a,function(f,g){b.$eval(d.ngModel+"=null"),b.$eval(a)?h[a]=!0:h[a]=!1,e(h)?c.removeAttr("readonly"):c.attr("readonly","true")})})}}}]).directive("jdSelectSingle",["$timeout",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){c.is("select")&&b.$watch(d.jdSelectSingle,function(b,c){b!=c&&b&&1===b.length&&a(function(){e.$setViewValue(b[0])},300)})}}}]).directive("jdDisableOn",["jedi.utilities.Utilities","$http",function(a,b){return{restrict:"A",link:function(b,c,d,e){function f(){c[0].disabled=!0,c.attr("disabled",!0);var a=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase());c.is('[type="submit"]')&&a&&c.submit()}d.jdDisableOn||(d.jdDisableOn="click"),a.bindFirst(c,d.jdDisableOn,f)}}}]),angular.module("jedi.utilities.filters",[]).filter("jdSelected",function(){return function(a,b){return b||(b="selected"),_.filter(a,function(a){return 1==a[b]})}}).filter("jdBoolToText",["$injector","jedi.utilities.UtilitiesConfig",function(a,b){var c;try{c=a.get("jedi.i18n.Localize")}catch(d){}var e=c?c.get(b.yesLabel):b.yesLabel,f=c?c.get(b.noLabel):b.noLabel;return function(a){return a===!0?e:f}}]).filter("jdTranslate",function(){return function(a){for(var b=1;b<arguments.length;b+=2)if(arguments[b]===a)return arguments[b+1]}}).filter("jdCapitalize",function(){return function(a){return a.charAt(0).toUpperCase()+a.substr(1)}}).filter("jdReplaceSpecialChars",function(){var a=[{val:"a",let:"áàãâä"},{val:"e",let:"éèêë"},{val:"i",let:"íìîï"},{val:"o",let:"óòõôö"},{val:"u",let:"úùûü"},{val:"c",let:"ç"},{val:"A",let:"ÁÀÃÂÄ"},{val:"E",let:"ÉÈÊË"},{val:"I",let:"ÍÌÎÏ"},{val:"O",let:"ÓÒÕÔÖ"},{val:"U",let:"ÚÙÛÜ"},{val:"C",let:"Ç"},{val:"",let:"?!()"}];return function(b){for(var c,d="",e=b,f=0;f<a.length;f++)c=new RegExp("["+a[f].let+"]","g"),e=e.replace(c,a[f].val),c=null;return e.replace(/\s/g,d)}}),angular.module("jedi.utilities",["jedi.dialogs","jedi.utilities.directives","jedi.utilities.filters"]),angular.module("jedi.utilities").constant("jedi.utilities.UtilitiesConfig",{yesLabel:"Yes",noLabel:"No"}).provider("jedi.utilities.Utilities",["$provide",function(a){var b=angular.injector(["ng"]).get("$log"),c=(angular.injector(["ng"]).get("$interpolate"),this);this.newGuid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},this.wrapElement=function(a,b,c){var d=angular.element(b);return a.after(d),c?d.prepend(a):d.append(a),d},this.validateCpf=function(a){var b,c,d;if(a=a.replace(/[^\d]+/g,""),""===a)return!0;if(11!=a.length||"00000000000"==a||"11111111111"==a||"22222222222"==a||"33333333333"==a||"44444444444"==a||"55555555555"==a||"66666666666"==a||"77777777777"==a||"88888888888"==a||"99999999999"==a)return!1;for(b=0,c=0;9>c;c++)b+=parseInt(a.charAt(c))*(10-c);if(d=11-b%11,(10==d||11==d)&&(d=0),d!=parseInt(a.charAt(9)))return!1;for(b=0,c=0;10>c;c++)b+=parseInt(a.charAt(c))*(11-c);return d=11-b%11,(10==d||11==d)&&(d=0),d!=parseInt(a.charAt(10))?!1:!0},this.validateCnpj=function(a){var b,c,d,e,f,g,h;if(a=a.replace(/[^\d]+/g,""),""===a)return!0;if(14!=a.length)return!1;if("00000000000000"==a||"11111111111111"==a||"22222222222222"==a||"33333333333333"==a||"44444444444444"==a||"55555555555555"==a||"66666666666666"==a||"77777777777777"==a||"88888888888888"==a||"99999999999999"==a)return!1;for(b=a.length-2,c=a.substring(0,b),e=a.substring(b),f=0,g=b-7,d=b;d>=1;d--)f+=c.charAt(b-d)*g--,2>g&&(g=9);if(h=2>f%11?0:11-f%11,h!=e.charAt(0))return!1;for(b+=1,c=a.substring(0,b),f=0,g=b-7,d=b;d>=1;d--)f+=c.charAt(b-d)*g--,2>g&&(g=9);return h=2>f%11?0:11-f%11,h!=e.charAt(1)?!1:!0},this.ngMaskDefaultAlias={"int":function(a){return"object"==typeof a&&(a.repeat="22"),"9?"},cpf:{mask:"999.999.999-99",validate:c.validateCpf},cnpj:{mask:"99.999.999/9999-99",validate:c.validateCnpj},cep:"99.999-999",tel:function(a){return"string"!=typeof a||8!=a.length&&9!=a.length?"(99) 9?9999-9999":"9?9999-9999"},date:"39/19/2999"},this.enableCors=function(a){b.info("Configurando headers padrões para habilizar CORS."),a.defaults.useXDomain=!0,angular.forEach(a.defaults.headers,function(a){delete a["X-Requested-With"]})},this.fixIISHttpHeaders=function(a){angular.forEach(a.defaults.headers,function(a){a["If-Modified-Since"]="Thu, 01 Jan 1970 00:00:00 GMT"})},this.configureRestangular=function(a){b.info("Configurando Restangular."),a.setRestangularFields({id:"_id.$oid"}),a.setRequestInterceptor(function(a,b,c){return"put"===b?(a._id=void 0,a):a}),a.addResponseInterceptor(function(a,b,c,d,e,f){var g={};return"object"==typeof a?g=a:g.result=a,("getList"===b||"post"===b)&&a.pageItems&&a.totalCount>=0?(g=a.pageItems,g.totalCount=a.totalCount,g.pageNo=a.pageNo):a instanceof ArrayBuffer&&(g.data=a,g.headers=e.headers()),g})},this.applyExceptionHandler=function(c){b.info("Registrando mecanismo de exception handler javascript."),a.decorator("$exceptionHandler",["$delegate","$injector",function(a,b){return function(d,e){a(d,e);var f;if("function"==typeof c&&(f=c(d,e)),!f)if(d&&d.message&&d.message.indexOf("$injector")>-1)f="Ocorreu algum erro desconhecido durante carregamento da página.";else{if(d&&d.message&&d.message.indexOf("$compile:tpload"))return;f="Ocorreu algum erro desconhecido de script."}try{var g=b.get("jedi.dialogs.AlertHelper");g.addError(f)}catch(h){alert(f)}}}])},this.applyModelStateMessages=function(a,b){var c;return a&&a.modelState?(c=[],angular.forEach(a.modelState,function(a,b){var d=jQuery("#"+b.replace(".","\\.")+',[name="'+b.replace(".","\\.")+'"]');d.length>0?(d.data("jd-modelstate-errors",a[0]),d.addClass("ng-dirty")):c.push({message:a[0],type:"text-danger"})}),0==c.length&&(c=void 0)):c=b,c},this.bindFirst=function(a,b,c){var d=$._data(a[0],"events");d=d&&d[b]?d[b].slice(0):[],a.unbind(b),a.on(b,c),angular.forEach(d,function(c){a.on(b,c.handler)})},this.getLocalStorage=function(a){return JSON.parse(localStorage.getItem(a))},this.setLocalStorage=function(a,b){return localStorage.setItem(a,JSON.stringify(b))},this.removeLocalStorage=function(a){return localStorage.removeItem(a)},this.$get=[function(){return{newGuid:c.newGuid,wrapElement:c.wrapElement,validateCpf:c.validateCpf,validateCnpj:c.validateCnpj,ngMaskDefaultAlias:c.ngMaskDefaultAlias,enableCors:c.enableCors,fixIISHttpHeaders:c.fixIISHttpHeaders,configureRestangular:c.configureRestangular,applyExceptionHandler:c.applyExceptionHandler,applyModelStateMessages:c.applyModelStateMessages,bindFirst:c.bindFirst,getLocalStorage:c.getLocalStorage,setLocalStorage:c.setLocalStorage,removeLocalStorage:c.removeLocalStorage}}]}]),angular.module("jedi.utilities").config(["$httpProvider",function(a){a.interceptors.push(["$q",function(a){return{response:function(b){return b&&b.config&&b.config.headers&&b.config.headers["Content-Type"]&&(b.config.headers["Content-Type"].toLowerCase().indexOf("json")>=0||b.config.headers["Content-Type"].toLowerCase().indexOf("form")>=0)&&$("[jd-disable-on]").removeAttr("disabled"),b||a.when(b)},responseError:function(b){return b&&b.config&&b.config.headers&&b.config.headers["Content-Type"]&&(b.config.headers["Content-Type"].toLowerCase().indexOf("json")>=0||b.config.headers["Content-Type"].toLowerCase().indexOf("form")>=0)&&$("[jd-disable-on]").removeAttr("disabled"),a.reject(b)}}}])}])});
//# sourceMappingURL=utilities.min.map